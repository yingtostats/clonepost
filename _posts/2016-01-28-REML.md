---
layout: post
title:  "MLE and REML Estimates"
date:  2016-01-28 21:00:00
tag:
- Statistics
- Code
projects: true
blog: false
author: Jannis
description: REML estimates and MLE estimates
fontsize: 23pt
---

{% include mathjax_support.html %}


### The Restricted Maximum Likelihood Estimates (REML)

#### Estimate $\sigma^2$,$\tau^2$, and the ﬁxed eﬀects $\beta$ via REML

*  I use lmer function in lme4 package to fit the model to obtain the
  REML estimates of the variance components
  $$\theta = (\sigma^2, \tau^2)$$ and the REML estimates of
  the fixed effects $\beta$.
  $$\hat{\theta}_{REML} = (\hat{\sigma}^{2}_{REML},\hat{\tau}^{2}_{REML}) = (42106.61, 5850.373)$$

<table>
<thead>
<tr class="header">
<th>Intercept</th>
<th>year1</th>
<th>AGE</th>
<th>SHARES</th>
<th>REV</th>
<th>INC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>513.56951705</td>
<td>78.93746000</td>
<td>-0.72576169</td>
<td>0.05438211</td>
<td>13.90654655</td>
<td>68.48501834</td>
</tr>
</tbody>
</table>

$$\hat{\beta}_{REML} = (513.56951705,78.93746000,-0.72576169,0.05438211,13.90654655,68.48501834)'$$



### Obtain standard error for the REML estimates of the ﬁxed eﬀects

*  We know that
  $$(X'\hat{V}^{-1}X)^{\frac{1}{2}}(\hat{\beta} - \beta) \dot{\sim} N(0, I_{p})$$
  $$V = V(\theta)=\sigma^{2} Z Z′+\tau^{2} I_{n}$$

*  Hence, first of all, we can obtain the REML estimator of $V(\theta)$ by
  replacing the variance components $\theta$ by the REML estimators of
  variance components $\hat{\theta}_{REML}$.
*  We call $$\hat{V}_{REML} = V(\hat{\theta}_{REML})$$ the REML
  estimator of V.
*  Then we plug in $\hat{V}_{REML}$ into
  $$S = Var(\hat{\beta}) = (X'\hat{V}^{-1}X)^{-1}$$
*  So we obtain the variance of REML estimates of fixed effects.
  $$\hat{S} = Var(\hat{\beta}) = (X'\hat{V}^{-1}X)^{-1}$$
*  Last we take the diagonals of $\hat{S}$ and the square root of that
  are the standard errors for the REML estimate of fixed effects. The
  $\beta_{j}$'s standard error is the j<sup>th</sup>
  element of the square root of the diagonal of S.

<table>
<thead>
<tr class="header">
<th>Intercept</th>
<th>year1</th>
<th>AGE</th>
<th>SHARES</th>
<th>REV</th>
<th>INC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>282.79806838</td>
<td>15.29754655</td>
<td>4.93312803</td>
<td>0.02941859</td>
<td>6.09109415</td>
<td>130.97186340</td>
</tr>
</tbody>
</table>



### Obtain the standard errors for the variance-component estimates.

Note that the R output does not include standard errors for the
REML estimates of the variance components.

There are two methods to obtain the s.e. for the variance-component
estimates.

#### Asymptotic Covariance pmatrix \(ACM\) method

*  The REML estimators are consistent and aymptoticallly normal
  uncer certain conditions. And symptotic covariance pmatrix is
  equal to the inverse of the restricted Fisher
  Information pmatrix. So under regularity conditions and assuming
  V is twice dfferentiable with respect to $\theta$.
*  Let REML estimates of variance components be
  $$\hat{\theta}_{REML} = (\hat{\sigma}^{2}_{REML},\hat{\tau}^{2}_{REML})$$.
  And we define
  $$\hat{P} = \hat{V}^{-1} - \hat{V}^{-1}X(X'\hat{V}^{-1}X)^{-1}X'\hat{V}^{-1}$$
*  The REML estimate of the inverse of the restricted Fisher
  Information pmatrix is
  $$I^{-1}(\hat{\theta}_{REML}) = \frac{1}{2}\begin{pmatrix}
  tr(\hat{P}ZZ'\hat{P}ZZ') & tr(\hat{P}^{2}ZZ') \\
  tr(\hat{P}^2ZZ') & tr(\hat{P}^{2})\end{pmatrix}^{-1} $$
*  Then we can obtain
  $$I^{-1}(\hat{\theta}_{REML}) =
  \begin{pmatrix}
  a^{*} & b^{*} \\
  c^{*} & d^{*}
  \end{pmatrix}$$
*  Hence $$s.e.(\hat{\sigma}^{2}_{REML}) = \sqrt{a^{*}}$$
  $$s.e.(\hat{\tau}^{2}_{REML}) = \sqrt{d^{*}}$$

#### Parametric Bootstrap \(PB\) method

*  Also let REML estimates of variance components be
  $$\hat{\theta}_{REML} = (\hat{\sigma}^{2}_{REML},\hat{\tau}^{2}_{REML})$$
  from the original data.
*  For b in 1:B repeat the following two steps for B times

  1.  Simulate a sample from this multivariate normal distribution
  $$N(X\hat{\beta},\hat{V(\theta)})$$
  2.  Fit a Linear Mixed Model to that sample to find REML estimates of $$\theta = (\sigma^{2}, \tau^{2})$$.
  3.  Let $$(\hat{\theta}^{(b)}_{\sigma^{2}},\hat{\theta}^{(b)}_{\tau^{2}})$$ be the REML estimates of $$\theta = (\sigma^{2},\tau^{2})$$ respectively from the sample.
*  The bootstrap estimates are

  $$\hat{\sigma}^{2}_{REML} = \sqrt{\frac{1}{B-1}\sum_{b=1}^{B}(\hat{\theta}^{(b)}_{\sigma^{2}}-\bar{\theta}_{\sigma^{2}})^{2}}$$

  $$\hat{\tau}^{2}_{REML} = \sqrt{\frac{1}{B-1}\sum_{b=1}^{B}(\hat{\theta}^{(b)}_{\tau^{2}}-\bar{\theta}_{\tau^{2}})^{2}}$$

  where $$\bar{\theta}_{\sigma^{2}}$$ is the mean of $$\hat{\theta}^{(b)}_{\sigma^{2}}$$ : b=1,2,3,...,B and
  $$\bar{\theta}_{\tau^{2}}$$ is the mean of
  $$\hat{\theta}^{(b)}_{\tau^{2}}$$ : b=1,2,3,...,B

#### Compute the standard errors of REML estimates via ACM method.

*  The standard errors for the REML estimates of the variance
  components by ACM method are
  $$s.e.(\hat{\sigma}^{2}_{REML}) = 9511.913$$
  $$s.e.(\hat{\tau}^{2}_{REML}) = 1181.954$$


#### Compute the standard errors in REML estimates via PB method.

*  The standard errors for the REML estimates of the variance
  components by PB method are
  $$s.e.(\hat{\sigma}^{2}_{REML}) = 9197.191$$
  $$s.e.(\hat{\tau}^{2}_{REML}) = 1184.55$$

#### Compare the results of ACM and PB Comment on what we observe.

*  The standard errors of $\hat{\sigma}^{2}_{REML}$ are much more
  higher than that of $\hat{\tau}^{2}_{REML}$ for both methods.
*  The standard errors I obtained for $\hat{\tau}^{2}_{REML}$ by two
  methods are more similar compared to the s.e. I obtained for
  $$\hat{\sigma}^{2}_{REML}$$ by two methods.
*  That is because of different degree of freedom of
  $$\hat{\tau}^{2}_{REML}$$ and $$\hat{\sigma}^{2}_{REML}$$. The
  standard error of $$\hat{\tau}^{2}_{REML}$$ is much more
  smaller since the degree of freedom is 99. The degree of freedom
  of $$\hat{\sigma}^{2}_{REML}$$ is 49.
